<?php 
include("./include_folder/include.php");
session_start();

if(isset($_SESSION["user_unique_id"])) {
    $user_unique_id = $_SESSION["user_unique_id"];
    $select_current_user = "select * from `secret_users` where user_unique_id = $user_unique_id";
    $select_current_result = mysqli_query($con, $select_current_user);
    $current_user_row = mysqli_num_rows($select_current_result);
    if($current_user_row >= 1) {
        $username = mysqli_fetch_assoc($select_current_result);
        $select_all_friend = "select * from `secret_friend_table` where friend_unique_id_1 = $user_unique_id or friend_unique_id_2 = $user_unique_id";
        $select_all_result = mysqli_query($con, $select_all_friend);
        $select_all_friend_row = mysqli_num_rows($select_all_result);
        if($select_all_friend_row >= 1) {
           $friend_true = true;
        } else {
            $friend_true = false;
        }
    }

    $online = "online";

    $coming_online = "update `secret_users` set user_online = '$online' where user_unique_id = $user_unique_id";
    $coming_online_result = mysqli_query($con, $coming_online);
} else {
    echo "<script>window.open('./sign_up_folder/sign_in.php', '_self')</script>";
}

?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Message</title>
     <!-- font awesome links start here -->
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
     integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
     crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- ends here -->
    <!-- font text start here -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
     href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&family=Karla:ital,wght@0,200..800;1,200..800&family=Kode+Mono:wght@400..700&family=Pacifico&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
     rel="stylesheet">
    <!-- ends here -->
    <script defer src="./message.js"></script>
    <link rel="stylesheet" href="./message.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
    <div class="message-container-div">
        <div class="user-container-div">
            <div class="user-container-div-1">

                <div class="search-user-div">
                    <input type="text" class="search-user-input" placeholder="Search Chat" readonly>
                </div>
                
                <div class="user-profile-div">
                    <?php 
                    if($friend_true) {
                    while($friends_data = mysqli_fetch_assoc($select_all_result)) {
                        $friend_unique_id_1 = $friends_data["friend_unique_id_1"];
                        $friend_unique_id_2 = $friends_data["friend_unique_id_2"];
                        $friend_username_1 = $friends_data["friend_username_1"];
                        $friend_username_2 = $friends_data["friend_username_2"];
                        if($friend_unique_id_1 == $user_unique_id) {
                            $friend_unique_id = $friend_unique_id_2;
                            $friend_username = $friend_username_2;
                        } else {
                            $friend_unique_id = $friend_unique_id_1;
                            $friend_username = $friend_username_1;
                        }
            

                    $select_friend_pic = "select * from `secret_users` where user_unique_id = $friend_unique_id and username = '$friend_username'";
                    $friend_pic_result = mysqli_query($con, $select_friend_pic);
                    $select_friend_pic_row = mysqli_num_rows($friend_pic_result);
                    if($select_friend_pic_row >= 1) {
                        $friend_pic_data = mysqli_fetch_assoc($friend_pic_result);
                        $friend_pic = $friend_pic_data["user_picture"]; 
                    } else {
                        continue;
                    }

                    $select_friend_message_id = "select max(msg_id) as newMessage from `users_chat` where sender_id = $friend_unique_id and sender_username = '$friend_username'";
                    $select_friend_message_result = mysqli_query($con, $select_friend_message_id);
                    $select_friend_message_row = mysqli_num_rows($select_friend_message_result);
                    if($select_friend_message_row >= 1) {
                        $select_friend_message_data = mysqli_fetch_assoc($select_friend_message_result);
                        $friend_msg_id = $select_friend_message_data["newMessage"];
                    }

                    if($friend_msg_id) {
                        $select_friend_msg = "select * from `users_chat` where msg_id = $friend_msg_id and sender_id = $friend_unique_id and sender_username = '$friend_username'";
                        $select_friend_msg_result = mysqli_query($con, $select_friend_msg);
                        $select_friend_msg_row = mysqli_num_rows($select_friend_msg_result);
                        if($select_friend_msg_row >= 1) {
                            $select_friend_msg_data = mysqli_fetch_assoc($select_friend_msg_result);
                            $friend_msg_content = $select_friend_msg_data["msg_content"];
                        }
                    } else {
                        $friend_msg_content = "Message Unavailable..!!";
                    }

                    echo "
                     <div class='user-message-profile message-users' data-user-unique-id='$friend_unique_id' data-friend-username='$friend_username'>
                        <div class='message-picture-div'>
                            <img src='./sign_up_folder/user_image/$friend_pic' alt='photo'>
                        </div>
                        <div class='message-data-div'>
                            <p class='message-username-p'>$friend_username</p>
                            <p class='message-p'>$friend_msg_content</p>
                        </div>
                        <div class='update-message-div'></div>
                    </div>
                    ";

                }


                   } else {
                    echo "
                     <div class='user-message-profile'>
                        <div class='message-picture-div'>
                            <img src='./user_home_folder/pixlr-image-generator-7f4fd879-a2ff-4d59-b38c-968bb6a7ce39.png' alt='photo'>
                        </div>
                        <div class='message-data-div'>
                            <p class='message-username-p'>SecretBook</p>
                            <p class='message-p'>No friend yet</p>
                        </div>
                        <div class='update-message-div'></div>
                    </div>
                    ";

                   }

                   if($friend_true) {

                   echo "
                    <div class='reload-message-page-div hidden' data-user-unique-id='$friend_unique_id' data-friend-username='$friend_username'>
                        <div class='loader hidden'></div>
                        <div class='loader1 hidden'></div>
                        <div class='loader2'></div>
                        <div class='loader3'>Refresh Chat</div>
                    </div>
                   ";
                }

                    ?>

                </div>
            </div>
        </div>
        <div class="chat-container-div">
            <div class="chat-container-nav-div hidden">
                <div class="chat-container-nav-1">
                    <div class="nav-1-icon-div">
                        <i class="fa-solid fa-arrow-left back-icon"></i>
                    </div>
                    <p class="username-p"></p>
                </div>
                <div class="chat-container-nav-2">
                    <div class="online-div"></div>
                    <div class="online-pic-div">
                       
                    </div>
                    <div class="nav-2-icon-div" onclick="history.back()">
                        <i class="fa-solid fa-xmark"></i>
                    </div>
                </div>
            </div>
            <div class="chat-main-div-1">
                <div class="chat-image-div">
                    <div class="chat-no-img">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" style="enable-background:new 0 0 256 256"
                            xml:space="preserve" class="no-chat-pic">
                            <style>
                                .st2 {
                                    fill: none;
                                    stroke: #6b1d1d;
                                    stroke-width: .5;
                                    stroke-miterlimit: 10
                                }
                        
                                .st3 {
                                    fill: #3a312a
                                }
                        
                                .st4 {
                                    fill: #87796f
                                }
                        
                                .st7 {
                                    fill: #fce8cb
                                }
                        
                                .st11 {
                                    fill: #d6df58
                                }
                        
                                .st12 {
                                    fill-rule: evenodd;
                                    clip-rule: evenodd;
                                    fill: #fce8cb
                                }
                        
                                .st13 {
                                    fill: #f5978a
                                }
                        
                                .st14 {
                                    fill: #d7e057
                                }
                        
                                .st16 {
                                    fill: #6ca8bf
                                }
                            </style>
                            <g id="Layer_1">
                                <path class="st11"
                                    d="M47.967 26.248s3.408 12.659 13.222 13.246c0 0-13.1 4.525-13.321 14.202 0 0-2.578-13.572-12.925-14.059-.001.001 12.05-1.825 13.024-13.389z" />
                                <path class="st3"
                                    d="M47.866 55.196a1.502 1.502 0 0 1-1.473-1.218c-.024-.124-2.494-12.417-11.521-12.843a1.5 1.5 0 0 1-.154-2.982c.441-.068 10.895-1.817 11.754-12.032a1.5 1.5 0 0 1 2.943-.266c.031.116 3.259 11.626 11.863 12.141a1.5 1.5 0 0 1 .402 2.914c-.121.042-12.119 4.311-12.312 12.82a1.5 1.5 0 0 1-1.502 1.466zm-7.741-15.729c3.879 1.969 6.23 5.745 7.587 8.876 2.026-4.021 5.941-6.787 8.949-8.427-4.134-1.843-6.783-5.651-8.334-8.723-1.793 4.361-5.271 6.869-8.202 8.274z" />
                                <path class="st11"
                                    d="M26.268 43.229s2.411 8.954 9.352 9.369c0 0-9.266 3.201-9.422 10.045 0 0-1.824-9.6-9.142-9.944 0 0 8.523-1.291 9.212-9.47z" />
                                <path class="st3"
                                    d="M26.196 64.144a1.502 1.502 0 0 1-1.473-1.22c-.016-.082-1.703-8.442-7.738-8.727a1.5 1.5 0 0 1-.154-2.982c.296-.047 7.363-1.242 7.941-8.113a1.501 1.501 0 0 1 1.361-1.368 1.506 1.506 0 0 1 1.581 1.101c.022.079 2.229 7.92 7.995 8.265a1.499 1.499 0 0 1 .4 2.915c-.081.028-8.283 2.953-8.413 8.662a1.5 1.5 0 0 1-1.5 1.467zm-4.518-11.528c2.108 1.332 3.524 3.394 4.447 5.279 1.376-2.232 3.515-3.872 5.364-4.973-2.286-1.27-3.884-3.35-4.941-5.224-1.173 2.288-3.015 3.877-4.87 4.918z" />
                                <path class="st11"
                                    d="M26.268 16.571s2.411 8.954 9.352 9.37c0 0-9.266 3.201-9.422 10.045 0 0-1.824-9.6-9.142-9.944 0 0 8.523-1.292 9.212-9.471z" />
                                <path class="st3"
                                    d="M26.196 37.486a1.502 1.502 0 0 1-1.473-1.22c-.016-.082-1.703-8.442-7.738-8.727a1.5 1.5 0 0 1-.154-2.982c.296-.047 7.363-1.243
                                     7.941-8.113a1.501 1.501 0 0 1 1.361-1.368 1.506 1.506 0 0 1 1.581 1.102c.022.079 2.229 7.92 7.995 8.265a1.499 1.499 0 0 
                                     1 .4 2.915c-.081.028-8.283 2.953-8.413 8.662a1.5 1.5 0 0 1-1.5 1.466zm-4.518-11.528c2.108 1.333 3.524 3.395 4.447 5.28 1.376-2.232 
                                     3.515-3.872 5.364-4.973-2.286-1.27-3.884-3.35-4.941-5.224-1.173 2.288-3.015 3.876-4.87 4.917z" />
                                <path class="st14"
                                    d="M148.441 27.491c26.954 2.144 50.837 18.003 63.339 41.671l-10.096-3.544a5.506 5.506 0 0 0-3.648 10.39l21.965 7.709a5.506 5.506 0 0 0 
                                    7.019-3.372l7.709-21.966a5.506 5.506 0 1 0-10.39-3.646l-3.084 8.787c-15.429-28.771-45.663-47.298-79.077-47.298-38.242 0-72.322 
                                    24.267-84.806 60.386a5.508 5.508 0 0 0 10.408 3.597c10.236-29.619 37.033-50.147 67.89-52.698l12.771-.016z" />
                                <path class="st3"
                                    d="M221.83 85.532a7.055 7.055 0 0 1-2.325-.398l-21.966-7.711a7.013 7.013 0 0 1-4.686-6.609c0-.792.134-1.573.396-2.321 1.279-3.643 
                                    5.284-5.568 8.93-4.289l6.351 2.229c-12.794-21.539-35.023-35.442-60.208-37.445a1.5 1.5 0 0 1-1.376-1.614 1.49 1.49 0 0 1 1.614-1.376c27.527 
                                    2.189 51.656 18.064 64.546 42.466a1.502 1.502 0 0 1-.189 1.68 1.496 1.496 0 0 1-1.634.436l-10.097-3.544a4.013 4.013 0 0 0-5.333 3.78 4.01 
                                    4.01 0 0 0 2.68 3.779l21.965 7.71a3.975 3.975 0 0 0 3.062-.169 3.99 3.99 0 0 0 2.046-2.285l7.709-21.966a3.978 3.978 0 0 0-.169-3.061 3.979 
                                    3.979 0 0 0-2.284-2.046 4.01 4.01 0 0 0-5.105 2.453l-3.086 8.787a1.499 1.499 0 0 1-2.737.212c-15.383-28.687-45.177-46.507-77.754-46.507-37.602 0-71.113 23.861-83.389 59.376a4.002 4.002 0 0 0 2.477 5.094 3.978 3.978 0 0 0 3.061-.183 3.978 3.978 0 0 0 2.033-2.294c10.372-30.007 37.528-51.087 69.185-53.704.81-.062 1.55.545 1.619 1.371a1.5 1.5 0 0 1-1.371 1.619c-30.473 2.519-56.613 22.81-66.597 51.694a6.959 6.959 0 0 1-3.558 4.011 6.951 6.951 0 0 1-5.351.321 7.01 7.01 0 0 1-4.334-8.91C68.648 39.395 103.3 14.722 142.18 14.722c32.564 0 62.439 17.221 78.762 45.166l1.984-5.651c1.276-3.644 5.281-5.569 8.93-4.291a6.964 6.964 0 0 1 3.995 3.578 6.957 6.957 0 0 1 .295 5.354l-7.709 21.966a6.96 6.96 0 0 1-3.577 3.994 6.997 6.997 0 0 1-3.03.694z" />
                                <path class="st14"
                                    d="M108.992 228.45c-26.676-2.355-50.264-18.143-62.661-41.612l10.096 3.544a5.506 5.506 0 0 0 3.648-10.39l-21.965-7.709a5.506 5.506 0 0 0-7.019 
                                    3.372l-7.709 21.966a5.506 5.506 0 0 0 10.39 3.646l3.084-8.787c15.43 28.771 45.663 47.299 79.077 47.299 38.241 0 72.322-24.268 84.806-60.386a5.507 
                                    5.507 0 0 0-10.407-3.597c-10.309 29.827-37.411 50.434-68.542 52.747l-12.798-.093z" />
                                <path class="st3"
                                    d="M115.933 241.278c-32.564 0-62.439-17.221-78.763-45.167l-1.983 5.651c-1.279 3.644-5.282 5.567-8.93 4.292a6.964 6.964 0 0 1-3.995-3.578 6.961 
                                    6.961 0 0 1-.295-5.354l7.709-21.966a6.963 6.963 0 0 1 3.575-3.994 6.96 6.96 0 0 1 5.354-.297l21.966 7.711a7.013 7.013 0 0 1 4.686 6.609c0 .789-.134
                                     1.569-.397 2.32a6.954 6.954 0 0 1-3.575 3.994 6.961 6.961 0 0 1-5.354.296l-6.349-2.229c12.664 21.311 34.645 35.189 59.542 37.387a1.5 1.5 0 1 
                                     1-.264 2.988c-27.228-2.403-51.099-18.256-63.855-42.405a1.502 1.502 0 0 1 .189-1.68 1.497 1.497 0 0 1 1.634-.436l10.096 3.544a3.98 3.98 0 0 0 3.062-.17 
                                     3.973 3.973 0 0 0 2.044-2.283c.152-.432.228-.878.228-1.327a4.01 4.01 0 0 0-2.681-3.779l-21.965-7.71a3.99 3.99 0 0 0-3.062.169 3.99 3.99 0 0 0-2.045 2.284l-7.709 
                                     21.967a3.978 3.978 0 0 0 .169 3.061 3.979 3.979 0 0 0 2.284 2.046 4.011 4.011 0 0 0 5.106-2.455l3.084-8.786a1.497 1.497 0 0 1 1.299-.998c.604-.061 1.157.263 1.438.786 
                                     15.384 28.688 45.178 46.508 77.755 46.508 37.603 0 71.113-23.861 83.388-59.376.148-.424.222-.863.222-1.309a4.008 4.008 0 0 0-2.699-3.786 4.01 4.01 0 0 0-5.094 
                                     2.478c-10.465 30.277-37.881 51.377-69.848 53.754a1.508 1.508 0 0 1-1.607-1.385 1.5 1.5 0 0 1 1.385-1.607c30.771-2.287 57.162-22.598 67.234-51.742 1.264-3.65 5.258-5.596 
                                     8.91-4.333a7.012 7.012 0 0 1 4.719 6.622 6.95 6.95 0 0 1-.387 2.291c-12.69 36.721-47.34 61.394-86.221 61.394z" />
                                <path class="st7"
                                    d="M238.944 164.071v-8.664a9.56 9.56 0 0 0-9.561-9.561h-6.317v-4.105c-1.747 1.211-3.555 1.926-5.309 1.926-1.683 0-3.459-.722-5.199-1.947h-.107v4.127h-6.32a9.56 9.56 0 0 
                                    0-9.561 9.561v8.664h42.374z" />
                                <path class="st3"
                                    d="M238.944 165.571H196.57a1.5 1.5 0 0 1-1.5-1.5v-8.664c0-6.1 4.962-11.061 11.062-11.061h4.82v-2.627a1.5 1.5 0 0 1 1.5-1.5h.106c.31 0 .611.096.864.274 1.554 1.095 3.053 
                                    1.674 4.335 1.674 1.368 0 2.866-.559 4.454-1.659a1.501 1.501 0 0 1 2.355 1.232v2.605h4.817c6.099 0 11.061 4.962 11.061 11.061v8.664a1.5 
                                    1.5 0 0 1-1.5 1.501zm-40.874-3h39.374v-7.164c0-4.445-3.616-8.061-8.061-8.061h-6.317a1.5 1.5 0 0 1-1.5-1.5v-1.535c-2.572 1.134-4.995 
                                    1.161-7.614-.047v1.582a1.5 1.5 0 0 1-1.5 1.5h-6.32c-4.445 0-8.062 3.616-8.062 8.061v7.164z" />
                                <path
                                    d="M238.944 164.072v-8.668a9.56 9.56 0 0 0-9.561-9.561h-1.511l.039.029-6.57 8.714-3.391-2.555-3.391 2.555-6.57-8.714.039-.029h-1.897a9.56 
                                    9.56 0 0 0-9.561 9.561v8.668h42.374z"
                                    style="fill:#8ac6dd" />
                                <path class="st3"
                                    d="M238.944 165.572H196.57a1.5 1.5 0 0 1-1.5-1.5v-8.668c0-6.1 4.962-11.061 11.062-11.061h1.896c.611 0 1.157.37 1.388.93l5.439 7.213 
                                    2.193-1.652a1.502 1.502 0 0 1 1.805 0l2.193 1.652 5.502-7.297c.248-.507.75-.846 1.324-.846h1.512c6.099 0 11.061 4.962 11.061 
                                    11.061v8.668a1.501 1.501 0 0 1-1.501 1.5zm-40.874-3h39.374v-7.168c0-4.445-3.616-8.061-8.061-8.061h-.703l-6.143 8.146a1.5 1.5 0 0 
                                    1-2.1.295l-2.488-1.875-2.488 1.875a1.503 1.503 0 0 1-2.1-.295l-6.143-8.146h-1.088c-4.445 0-8.062 3.616-8.062 8.061v7.168z" />
                                <path class="st12" d="M205.102 122.145a3.762 3.762 0 1 1-7.523 0 3.762 3.762 0 0 1 7.523 0z" />
                                <path class="st3"
                                    d="M201.34 127.407a5.268 5.268 0 0 1-5.262-5.262 5.268 5.268 0 0 1 5.262-5.263 5.268 5.268 0 0 1 5.263 5.263 5.269 5.269 0 0 1-5.263 5.262zm0-7.524a2.265 2.265 0 0 0-2.262 2.263 2.265 2.265 0 0 0 2.262 2.262 2.265 2.265 0 0 0 2.263-2.262 2.265 2.265 0 0 0-2.263-2.263z" />
                                <path class="st12" d="M237.938 122.145a3.762 3.762 0 1 1-7.523 0 3.762 3.762 0 0 1 7.523 0z" />
                                <path class="st3"
                                    d="M234.176 127.407a5.268 5.268 0 0 1-5.262-5.262 5.268 5.268 0 0 1 5.262-5.263 5.268 5.268 0 0 1 5.262 5.263 5.268 5.268 0 0 1-5.262 5.262zm0-7.524a2.265 2.265 0 0 0-2.262 2.263c0 1.247 1.015 2.262 2.262 2.262s2.262-1.015 2.262-2.262a2.264 2.264 0 0 0-2.262-2.263z" />
                                <path class="st7"
                                    d="M234.435 120.319c0 9.211-8.87 23.348-16.677 23.348-7.452 0-16.677-14.137-16.677-23.348s7.467-16.677 16.677-16.677c9.211 0 16.677 7.466 16.677 16.677z" />
                                <path class="st3"
                                    d="M217.758 145.167c-8.428 0-18.177-15.037-18.177-24.848 0-10.023 8.154-18.178 18.177-18.178s18.178 8.154 18.178 18.178c0 10.037-9.576 24.848-18.178 24.848zm0-40.025c-8.368 0-15.177 6.809-15.177 15.178 0 8.984 8.936 21.848 15.177 21.848 5.855 0 15.178-11.93 15.178-21.848 0-8.37-6.809-15.178-15.178-15.178z" />
                                <path class="st3"
                                    d="M213.498 120.131a1.628 1.628 0 1 1-3.256 0 1.628 1.628 0 0 1 3.256 0zM225.274 120.131a1.628 1.628 0 1 1-3.256 0 1.628 1.628 0 0 1 3.256 0z" />
                                <ellipse class="st13" cx="208.617" cy="124.97" rx="2.804" ry="2.096" />
                                <path class="st13"
                                    d="M229.703 124.97c0 1.158-1.255 2.096-2.804 2.096s-2.804-.938-2.804-2.096 1.256-2.096 2.804-2.096c1.549 0 2.804.938 2.804 2.096z" />
                                <path class="st4"
                                    d="M217.951 99.961c-9.533 0-17.262 7.389-17.262 16.503 0 .965.174 1.683.499 2.581.153.423 2.625-.929 2.835-1.077 1.052-.741 1.912-1.745 
                                    2.555-2.856.266-.462.488-.932.666-1.402.569-1.499 2.115-5.671 3.685-5.343 2.105.439 4.491.687 7.022.687 2.531 0 4.917-.248 7.022-.687 
                                    1.57-.327 3.116 3.844 3.685 5.343.178.47.4.94.666 1.402 1.062 1.837 2.855 3.585 5.037 3.904.005-.105.138-.141.238-.177.714-.259.614-1.803.614-2.375-.001-9.114-7.729-16.503-17.262-16.503z" />
                                <path class="st3"
                                    d="M201.311 120.615a1.66 1.66 0 0 1-.493-.068 1.61 1.61 0 0 1-1.041-.989c-.354-.98-.589-1.881-.589-3.093 0-9.928 
                                    8.416-18.004 18.762-18.004s18.762 8.076 18.762 18.003l.002.172c.014.931.041 2.816-1.372 3.515l-.026.023c-.327.27-.754.389-1.171.327-2.352-.342-4.64-2.075-6.12-4.637a11.248 
                                    11.248 0 0 1-.77-1.621l-.036-.098c-1.176-3.101-1.86-4.001-2.17-4.262-2.221.446-4.607.672-7.098.672-2.489 0-4.876-.226-7.097-.672-.311.261-.996 1.163-2.173 4.271a11.614 
                                    11.614 0 0 1-.802 1.707c-.785 1.355-1.819 2.508-2.993 3.334-.021.015-2.135 1.42-3.575 1.42zm34.547-1.523zm0-.003c0 .001 0 .001 0 0 0 .001 
                                    0 .001 0 0zm0-.003v.002-.002zm-10.667-12.242c2.265 0 3.677 3.194 4.831 6.238l.037.098c.152.402.342.801.562 1.184.82 1.42 1.932 2.462 3.087 
                                    2.93.011-.241.007-.493.005-.613l-.002-.216c0-8.272-7.07-15.003-15.762-15.003-8.691 0-15.762 6.73-15.762 15.004 0 .271.016.514.052.761.395-.192.785-.401.951-.505.788-.557 
                                    1.521-1.38 2.089-2.358.219-.382.408-.78.561-1.184 1.274-3.366 2.829-6.812 5.393-6.279 4.114.859 9.321.859 13.432 0 .181-.039.356-.057.526-.057z" />
                                <path transform="rotate(-37.003 212.967 148.932)" class="st4" d="M210.846 143.488h4.263v10.914h-4.263z" />
                                <path class="st3"
                                    d="M214.56 156.086a1.503 1.503 0 0 1-1.198-.598l-6.568-8.716a1.497 1.497 0 0 1 .296-2.1l3.405-2.566a1.501 1.501 0 0 1 2.101.295l6.568 8.716a1.497 1.497 
                                    0 0 1-.296 2.1l-3.405 2.566a1.497 1.497 0 0 1-.903.303zm-4.468-9.921 4.763 6.32 1.01-.761-4.763-6.319-1.01.76z" />
                                <path transform="rotate(-142.997 222.923 148.94)" class="st4" d="M220.791 143.488h4.263v10.914h-4.263z" />
                                <path class="st3"
                                    d="M221.341 156.086a1.5 1.5 0 0 1-.903-.302l-3.404-2.566a1.501 1.501 0 0 1-.295-2.101l6.568-8.716a1.501 1.501 0 0 1 2.101-.295l3.405 2.566a1.503 1.503 0 0 
                                    1 .296 2.101l-6.569 8.716a1.508 1.508 0 0 1-1.199.597zm-1.304-4.361 1.009.761 4.764-6.32-1.01-.76-4.763 6.319zM204.508 165.572a1.5 1.5 0 0 1-1.5-1.5v-6.849a1.5 1.5 0 0 
                                    1 3 0v6.849a1.5 1.5 0 0 1-1.5 1.5z" />
                                <path class="st4"
                                    d="M203.65 103.2c2.831 3.565 6.217 7.365 10.307 8.528 6.588 1.873 18.247-.464 18.247-9.945 0-6.063-5.082-13.391-14.566-7.812-11.756 6.916-18.58-6.379-18.58-.316 0 
                                    1.917.772 3.828 1.786 5.567l2.806 3.978z" />
                                <path class="st3"
                                    d="M218.546 113.815c-1.811 0-3.533-.229-4.999-.646-4.421-1.257-7.934-5.087-11.071-9.038l-.051-.067-2.806-3.977a1.275 1.275 0 0 1-.07-.11c-1.339-2.297-1.99-4.365-1.99-6.322 
                                    0-.594 0-2.173 1.217-2.861 1.259-.716 2.541.06 4.166 1.032 3.033 1.821 7.618 4.571 13.936.851 5.424-3.19 9.246-2.325 11.496-1.036 3.238 1.853 5.331 5.833 5.331 10.141 0 
                                    3.605-1.509 6.65-4.362 8.806-3.001 2.267-7.085 3.227-10.797 3.227zM204.852 102.3c2.818 3.547 5.922 6.963 9.516 7.985 3.662 1.041 9.521.663 13.168-2.091 2.104-1.589 
                                    3.17-3.746 3.17-6.412 0-2.664-1.182-6.027-3.82-7.536-2.239-1.28-5.175-.929-8.485 1.018-7.854 4.62-13.804 1.053-17.001-.864a41.379 41.379 0 0 0-.834-.492c.057 1.332.563 
                                    2.81 1.544 4.505l2.742 3.887zM217.758 135.347c-2.741 0-4.803-1.287-5.963-3.724a1.5 1.5 0 0 1 2.709-1.289c.663 1.392 1.666 2.013 3.254 2.013 1.829 0 2.918-1.133 
                                    3.203-1.895a1.5 1.5 0 1 1 2.809 1.053c-.693 1.85-2.87 3.842-6.012 3.842zM231.394 165.572a1.5 1.5 0 0 1-1.5-1.5v-6.849a1.5 1.5 0 0 1 3 0v6.849a1.5 1.5 0 0 1-1.5 1.5z" />
                                <path class="st4" d="M20.22 112.935h35.793v40.968H20.22z" />
                                <path class="st3"
                                    d="M56.013 155.403H20.22a1.5 1.5 0 0 1-1.5-1.5v-40.969a1.5 1.5 0 0 1 1.5-1.5h35.793a1.5 1.5 0 0 1 1.5 1.5v40.969a1.5 1.5 0 0 1-1.5 1.5zm-34.293-3h32.793v-37.969H21.72v37.969z" />
                                <path class="st7"
                                    d="M59.54 155.407v8.664H17.167v-8.664a9.56 9.56 0 0 1 9.561-9.561h6.32v-4.127h.107c1.74 1.226 3.516 1.947 5.199 1.947 1.754 0 3.562-.715 5.309-1.926v4.105h6.317a9.562 9.562
                                     0 0 1 9.56 9.562z" />
                                <path class="st3"
                                    d="M59.54 165.571H17.167a1.5 1.5 0 0 1-1.5-1.5v-8.664c0-6.1 4.962-11.061 11.06-11.061h4.82v-2.627a1.5 1.5 0 0 1 1.5-1.5h.107c.309 0 .611.096.864.273 1.554 1.095 3.052 
                                    1.674 4.334 1.674 1.37 0 2.868-.558 4.453-1.658a1.499 1.499 0 0 1 2.356 1.232v2.605h4.817c6.099 0 11.061 4.962 11.061 11.061v8.664a1.5 1.5 0 0 1-1.499 
                                    1.501zm-40.873-3H58.04v-7.164c0-4.445-3.616-8.061-8.061-8.061h-6.317a1.5 1.5 0 0 1-1.5-1.5v-1.535c-2.569 1.131-4.994 1.161-7.614-.048v1.583a1.5 1.5 0 0 1-1.5 
                                    1.5h-6.32c-4.444 0-8.06 3.616-8.06 8.061v7.164z" />
                                <path
                                    d="M59.54 155.404v8.668H17.167v-8.668a9.56 9.56 0 0 1 9.561-9.561h1.897l-.039.029 6.57 8.714 3.391-2.555 3.391 2.555 6.57-8.714-.039-.029h1.512c5.279 0 9.559 4.281 
                                    9.559 9.561z"
                                    style="fill:#f16c7a" />
                                <path class="st3"
                                    d="M59.54 165.572H17.167a1.5 1.5 0 0 1-1.5-1.5v-8.668c0-6.1 4.962-11.061 11.06-11.061h1.898c.611 0 1.157.37 1.388.93l5.438 7.213 2.193-1.652a1.502 1.502 0 0 1 1.805 
                                    0l2.193 1.652 5.501-7.295a1.474 1.474 0 0 1 1.324-.848h1.512c6.099 0 11.061 4.962 11.061 11.061v8.668a1.5 1.5 0 0 1-1.5 1.5zm-40.873-3H58.04v-7.168c0-4.445-3.616-8.061-8.061-8.061h-.702l-6.142 
                                    8.146a1.5 1.5 0 0 1-2.1.295l-2.488-1.875-2.488 1.875a1.503 1.503 0 0 1-2.1-.295l-6.143-8.146h-1.089c-4.444 0-8.06 3.616-8.06 8.061v7.168z" />
                                <path class="st12" d="M25.698 122.145a3.762 3.762 0 1 1-7.523 0 3.762 3.762 0 0 1 7.523 0z" />
                                <path class="st3"
                                    d="M21.936 127.407a5.268 5.268 0 0 1-5.263-5.262 5.268 5.268 0 0 1 5.263-5.263 5.268 5.268 0 0 1 5.262 5.263 5.267 5.267 0 0 1-5.262 5.262zm0-7.524a2.265 
                                    2.265 0 0 0-2.263 2.263 2.265 2.265 0 0 0 2.263 2.262 2.265 2.265 0 0 0 2.262-2.262 2.264 2.264 0 0 0-2.262-2.263z" />
                                <circle class="st12" cx="54.772" cy="122.145" r="3.762" />
                                <path class="st3"
                                    d="M54.771 127.407a5.268 5.268 0 0 1-5.262-5.262 5.268 5.268 0 0 1 5.262-5.263 5.268 5.268 0 0 1 5.263 5.263 5.267 5.267 0 0 1-5.263 5.262zm0-7.524a2.265
                                     2.265 0 0 0-2.262 2.263 2.265 2.265 0 0 0 2.262 2.262 2.265 2.265 0 0 0 2.263-2.262 2.265 2.265 0 0 0-2.263-2.263z" />
                                <path class="st7"
                                    d="M55.031 120.319c0 9.211-8.871 23.348-16.677 23.348-7.452 0-16.677-14.137-16.677-23.348s7.467-16.677 16.677-16.677c9.211 0 16.677 7.466 16.677 16.677z" />
                                <path class="st3"
                                    d="M38.353 145.167c-8.428 0-18.177-15.037-18.177-24.848 0-10.023 8.154-18.178 18.177-18.178 10.024 0 18.178 8.154 18.178 18.178 0 10.037-9.575 24.848-18.178 
                                    24.848zm0-40.025c-8.368 0-15.177 6.809-15.177 15.178 0 8.984 8.936 21.848 15.177 21.848 5.856 0 15.178-11.93 15.178-21.848 0-8.37-6.808-15.178-15.178-15.178z" />
                                <path class="st3"
                                    d="M34.094 120.131a1.628 1.628 0 1 1-3.256 0 1.628 1.628 0 0 1 3.256 0zM45.87 120.131a1.628 1.628 0 1 1-3.256 0 1.628 1.628 0 0 1 3.256 0z" />
                                <ellipse class="st13" cx="29.213" cy="124.97" rx="2.804" ry="2.096" />
                                <ellipse class="st13" cx="47.495" cy="124.97" rx="2.804" ry="2.096" />
                                <path transform="rotate(-37.003 33.574 148.935)" class="st4" d="M31.442 143.488h4.263v10.914h-4.263z" />
                                <path class="st3"
                                    d="M35.155 156.086a1.503 1.503 0 0 1-1.198-.598l-6.568-8.716a1.497 1.497 0 0 1 .296-2.1l3.405-2.566a1.502 1.502 0 0 1 2.101.295l6.568 8.716a1.497 1.497 0 0
                                     1-.296 2.1l-3.405 2.566a1.495 1.495 0 0 1-.903.303zm-4.468-9.921 4.763 6.32 1.01-.761-4.763-6.319-1.01.76z" />
                                <path transform="rotate(-142.997 43.52 148.943)" class="st4" d="M41.388 143.488h4.263v10.913h-4.263z" />
                                <path class="st3"
                                    d="M41.937 156.086c-.324 0-.642-.105-.902-.302l-3.405-2.566a1.496 1.496 0 0 1-.296-2.1l6.568-8.716a1.501 1.501 0 0 1 2.101-.295l3.405 2.566a1.503 1.503 0 0
                                     1 .296 2.1l-6.568 8.716a1.505 1.505 0 0 1-1.199.597zm-1.304-4.361 1.01.761 4.763-6.32-1.01-.76-4.763 6.319zM25.103 165.572a1.5 1.5 0 0 1-1.5-1.5v-6.849a1.5 
                                     1.5 0 0 1 3 0v6.849a1.5 1.5 0 0 1-1.5 1.5zM51.989 165.572a1.5 1.5 0 0 1-1.5-1.5v-6.849a1.5 1.5 0 0 1 3 0v6.849a1.5 1.5 0 0 1-1.5 1.5zM38.353 135.347c-2.741 
                                     0-4.803-1.287-5.963-3.724a1.5 1.5 0 0 1 2.709-1.289c.663 1.392 1.666 2.013 3.254 2.013 1.83 0 2.919-1.133 3.204-1.895a1.5 1.5 0 1 1 2.809 1.053c-.692 
                                     1.85-2.87 3.842-6.013 3.842z" />
                                <path class="st4"
                                    d="M57.334 114.207c0 1.709-.222 3.365-.642 4.942-4.272-2.059-8.335-4.588-12.099-7.446a53.736 53.736 0 0 1-3.23-2.632 32.514 32.514 0 0 
                                    1-3.567-3.629c-2.365-2.848-4.101-6.119-5.57-9.526a19.07 19.07 0 0 1 5.89-.924 19.167 19.167 0 0 1 13.961 6.011 19.134 19.134 0 0 1 5.257 13.204z" />
                                <path class="st3"
                                    d="M56.691 120.648c-.223 0-.445-.05-.651-.148-4.257-2.053-8.414-4.61-12.355-7.603a54.479 54.479 0 0 1-3.319-2.707 34.109 34.109 0 0 
                                    1-3.722-3.789c-2.172-2.614-4.013-5.758-5.796-9.893a1.498 1.498 0 0 1 .916-2.021 20.561 20.561 0 0 1 6.351-.997c5.75 0 11.095 2.302 15.051 6.48a20.616 20.616 
                                    0 0 1 5.668 14.235c0 1.809-.233 3.602-.693 5.327a1.5 1.5 0 0 1-1.45 1.116zm-22.38-23.746c1.442 3.095 2.937 5.531 4.639 7.581a31.245 31.245 0 0 0 3.401 3.459 
                                    51.74 51.74 0 0 0 3.146 2.565 70.58 70.58 0 0 0 10.127 6.43 17.87 17.87 0 0 0 .209-2.73 17.63 17.63 0 0 0-4.847-12.173c-3.384-3.574-7.955-5.543-12.872-5.543a17.7 17.7 
                                    0 0 0-3.803.411z" />
                                <path class="st4"
                                    d="M52.076 101.003c-3.306 3.014-6.904 5.682-10.714 8.067-6.755 4.233-14.162 7.574-21.743 10.356a19.168 19.168 0 0 1-.719-5.22c0-8.557 5.595-15.808 
                                    13.325-18.291a19.07 19.07 0 0 1 5.89-.924 19.17 19.17 0 0 1 13.961 6.012z" />
                                <path class="st3"
                                    d="M19.619 120.926a1.5 1.5 0 0 1-1.444-1.092 20.671 20.671 0 0 1-.775-5.627c0-9.035 5.773-16.96 14.366-19.72a20.559 20.559 0 0 1 6.349-.996c5.75 0 11.095 
                                    2.302 15.051 6.48a1.505 1.505 0 0 1-.079 2.14c-3.223 2.938-6.899 5.707-10.929 8.23-6.248 3.916-13.452 7.348-22.022 10.492a1.462 1.462 0 0 
                                    1-.517.093zm18.496-24.435c-1.858 0-3.685.286-5.428.851A17.654 17.654 0 0 0 20.4 114.207c0 1.085.098 2.162.292 3.218 7.677-2.908 14.191-6.064 19.873-9.626 
                                    3.388-2.121 6.513-4.419 9.309-6.845-3.241-2.889-7.361-4.463-11.759-4.463z" />
                                <circle cx="128.056" cy="128.028" r="62" style="fill:#8ac5dc" />
                                <path class="st3"
                                    d="M128.056 191.528c-35.014 0-63.5-28.486-63.5-63.5s28.486-63.5 63.5-63.5c35.014 0 63.5 28.486 63.5 63.5s-28.487 63.5-63.5 63.5zm0-124c-33.359 0-60.5 
                                    27.141-60.5 60.5s27.141 60.5 60.5 60.5 60.5-27.141 60.5-60.5-27.141-60.5-60.5-60.5z" />
                                <path class="st3"
                                    d="M128.056 191.528c-23.686 0-42.955-28.486-42.955-63.5s19.269-63.5 42.955-63.5 42.955 28.486 42.955 63.5-19.27 63.5-42.955 63.5zm0-124c-22.031 0-39.955 
                                    27.141-39.955 60.5s17.924 60.5 39.955 60.5 39.955-27.141 39.955-60.5-17.924-60.5-39.955-60.5z" />
                                <path class="st3"
                                    d="M128.056 191.528c-11.416 0-17.576-32.717-17.576-63.5s6.16-63.5 17.576-63.5 17.576 32.717 17.576 63.5-6.16 63.5-17.576 63.5zm0-124c-6.895 0-14.576 
                                    24.847-14.576 60.5s7.682 60.5 14.576 60.5c6.895 0 14.576-24.847 14.576-60.5s-7.682-60.5-14.576-60.5z" />
                                <path class="st3"
                                    d="M128.056 170.983c-35.014 0-63.5-19.27-63.5-42.955 0-23.686 28.486-42.955 63.5-42.955 35.014 0 63.5 19.27 63.5 42.955 0 23.686-28.487 42.955-63.5 
                                    42.955zm0-82.91c-33.359 0-60.5 17.924-60.5 39.955s27.141 39.955 60.5 39.955 60.5-17.924 60.5-39.955-27.141-39.955-60.5-39.955z" />
                                <path class="st3"
                                    d="M128.056 145.605c-30.783 0-63.5-6.16-63.5-17.576s32.717-17.576 63.5-17.576 63.5 6.16 63.5 17.576-32.717 17.576-63.5 17.576zm0-32.153c-35.653 0-60.5 
                                    7.682-60.5 14.576 0 6.895 24.847 14.576 60.5 14.576s60.5-7.682 60.5-14.576-24.847-14.576-60.5-14.576z" />
                                <path class="st16"
                                    d="M185.926 145.689c-5.87 19.18-21.03 34.34-40.21 40.21 7.04-4.72 13.09-12.16 17.5-21.43.14-.29.28-.58.41-.87.1-.05.21-.1.31-.15 
                                    9.529-4.421 17.17-10.581 21.99-17.76zM187.806 134.298c-2.32 9.67-9.92 18.2-20.77 24.24a61.378 61.378 0 0 0 6.77-18.09c6.02-1.66 
                                    10.89-3.719 14-6.15zM185.926 110.368c-4.82-7.18-12.46-13.34-21.99-17.76-.1-.05-.21-.1-.31-.15-.13-.29-.27-.58-.41-.87-4.41-9.27-10.46-16.71-17.5-21.43 19.18 
                                    5.87 34.34 21.03 40.21 40.21zM152.436 80.138a62.143 62.143 0 0 0-16.73-9.84c-.44-.74-.91-1.41-1.38-2.02 6.74 1.62 12.93 5.8 18.11 11.86zM187.806 
                                    121.758c-3.11-2.43-7.98-4.49-14-6.15a61.378 61.378 0 0 0-6.77-18.09c10.85 6.04 18.45 14.57 20.77 24.24zM188.556 128.028c0 3.15-5.18 6.45-14.17 
                                    9.11.44-2.97.67-6.01.67-9.11 0-3.1-.23-6.14-.67-9.11 8.99 2.66 14.17 5.96 14.17 9.11zM152.436 175.918c-5.18 6.06-11.37 10.24-18.11 11.86.47-.61.94-1.28 
                                    1.38-2.02 6.11-2.4 11.74-5.74 16.73-9.84z" />
                            </g>
                        </svg>
                    </div>
                    <div class="no-chat-p-div">
                        <p>Share a new secret by tapping friends profile..!!</p>
                    </div>
                </div>
            </div>

            <div class="chat-main-div-2 hidden">
                <div class="chat-div">
                    <div class="message-main-container" id="idolo">

                    

                        
                    </div>

                    <div class="message-text-input-div">
                        <form action="./function_folder/common_function_2.php" method="post" class="message-form" target='the-iframe'>
                            <input type="text" placeholder="Spread your secret" class="message-input" name="message-input" autocomplete="off">
                            <input type="submit" class="message-submit" value="" name="message-submit">
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- <div class="reload-message-page-div">
        <div class="loader hidden"></div>
        <div class="loader1 hidden"></div>
        <div class="loader2"></div>
        <div class="loader3">Refresh Chat</div>
    </div> -->

    <iframe name="the-iframe" class="the-iframe-class"></iframe>
</body>
</html>

<script type="text/javascript">
    $(document).ready(function () {
        function startUpMessage() {
            $(".message-users").click(function() {
                var unique_id = $(this).data("user-unique-id");
                var username = $(this).data("friend-username");
                $.post("./function_folder/common_function_1.php", {all_friend_id: unique_id, all_friend_username: username}, function() {
                    console.log("SecretBook is the best");
                });

                $(".message-main-container").load("message_result.php");
                $(".username-p").load("message_username.php", {friend_username: username});
                $(".online-div").load("message_online.php", {friend_unique_id: unique_id, friend_username: username});
                $(".online-pic-div").load("message_profile.php", {friend_unique_id: unique_id});
                $(".reload-message-page-div").removeClass("hidden");
            });
        }

        function newMessage() {
            $(".message-form").submit(function() {
                const timesubmit = setInterval(() => {        
                    $(".message-input").val("");
                    $(".message-main-container").load("message_result.php");
                    clearInterval(timesubmit);
                }, 1000);
            });
        }

        function freshMessage() {
            $(".reload-message-page-div").click(function() {
                $(".loader").removeClass("hidden");
                $(".loader1").removeClass("hidden");
                $(".loader2").addClass("hidden");
                $(".loader3").addClass("hidden");
                var unique_id = $(this).data("user-unique-id");
                var username = $(this).data("friend-username");
                $(".message-main-container").load("message_result.php", {all_friend_id: unique_id, all_friend_username: username}, function () {
                    const timesubmit = setInterval(() => {   
                        $(".loader3").removeClass("hidden");
                        $(".loader2").removeClass("hidden");
                        $(".loader1").addClass("hidden");
                        $(".loader").addClass("hidden");     
                    clearInterval(timesubmit);
                }, 2000);
                })
            });
        }

        newMessage();
        startUpMessage();
        freshMessage();
    });
</script>

